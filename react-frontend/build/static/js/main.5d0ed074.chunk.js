(this["webpackJsonpreact-frontend"]=this["webpackJsonpreact-frontend"]||[]).push([[0],{18:function(e,t,a){e.exports=a(35)},23:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(15),o=a.n(c),i=(a(23),a(1)),l=a(4),s=a(2),m=r.a.createContext({isAuthenticated:!1,setIsAuthenticated:function(){}}),u=a(17),d=function(e){var t=e.children,a=Object(u.a)(e,["children"]);return r.a.createElement(s.b,Object.assign({},a,{render:function(e){var a=e.location;return localStorage.getItem("accessToken")?t:r.a.createElement(s.a,{to:{pathname:"/auth/login",state:{from:a}}})}}))},f=(a(29),a(30),function(){var e=Object(n.useContext)(m).setIsAuthenticated,t=Object(s.g)();return r.a.createElement("h3",{onClick:function(){return function(){var a={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token  ".concat(localStorage.getItem("accessToken"))}};fetch("/api/auth/logout/",a).then((function(a){204===a.status&&(localStorage.removeItem("accessToken"),e(!1),t.push("/"))})).catch((function(e){return alert(e)}))}()},className:"nav-btn cursor clicked"},"Logout")}),h=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useContext)(m).isAuthenticated;return Object(n.useEffect)((function(){var e={method:"GET",headers:{Authorization:"Token ".concat(localStorage.getItem("accessToken"))}};fetch("/api/profiles/current/user/",e).then((function(e){return e.json()})).then((function(e){return c(e.username)})).catch((function(e){return console.log(e)}))}),[]),r.a.createElement("header",{id:"main-header"},r.a.createElement("div",{className:"container flexed"},r.a.createElement(l.b,{to:"/"},r.a.createElement("h1",{className:"cursor clicked"},"TwitterClone")),r.a.createElement("nav",{className:"nav-bar flexed"},r.a.createElement(l.b,{to:"/home"},r.a.createElement("h3",{className:"nav-btn cursor clicked"},"Home")),o&&r.a.createElement(l.b,{to:"profile/".concat(a,"/")},r.a.createElement("h3",{className:"nav-btn cursor clicked"},a)),!o&&r.a.createElement(l.b,{to:"/auth/login"},r.a.createElement("h3",{className:"nav-btn cursor clicked"},"Login")),o&&r.a.createElement(f,null))))},E=(a(31),a(32),function(e){return r.a.createElement("p",{className:e.propClass},e.message)}),p=function(e){var t=Object(n.useState)(""),a=Object(i.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),s=Object(i.a)(l,2),m=s[0],u=s[1],d=Object(n.useState)(null),f=Object(i.a)(d,2),h=f[0],p=f[1];return r.a.createElement("form",{onSubmit:function(t){return function(t){t.preventDefault();var a={content:c},n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("accessToken"))},body:JSON.stringify(a)};fetch("/api/tweets/create/",n).then((function(t){if(201===t.status)return e.onTweetAdd(),t.json();if(400===t.status)throw new Error("Try a shorter tweet");if(401===t.status)throw new Error("Login first to perform this action")})).then((function(){o("")})).catch((function(e){o(""),u(!0),p(e.message)}))}(t)},action:"",method:"POST",id:"tweet-create-form",className:"form-container"},r.a.createElement("div",{className:"form-item"},r.a.createElement("label",{htmlFor:"id_content"},"Content: "),r.a.createElement("textarea",{name:"content",id:"id_content",cols:"50",rows:"7",placeholder:"Your tweet...",required:!0,value:c,onChange:function(e){return o(e.target.value)}})),m&&r.a.createElement("div",{className:"form-item"},r.a.createElement(E,{propClass:"failure",message:h})),r.a.createElement("div",{className:"form-item"},r.a.createElement("button",{type:"submit",className:"prim-btn cursor"},"Tweet")))},b=function(e){var t=Object(n.useState)(e.tweetLikes),a=Object(i.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(e.isLiked),s=Object(i.a)(l,2),m=s[0],u=s[1];return r.a.createElement("button",{onClick:function(){return function(e){var t="/api/tweets/".concat(e,"/like/"),a={method:"POST",headers:{Authorization:"Token ".concat(localStorage.getItem("accessToken"))}};fetch(t,a).then((function(e){if(200===e.status)return e.json();if(401===e.status)throw new Error("Login first to perform this action")})).then((function(e){"like"===e.type?o(c+1):o(c-1),"like"===e.type?u(!0):u(!1)})).catch((function(e){alert(e)}))}(e.tweetId)},className:"prim-btn tweet-container-item cursor"},!m&&c+" likes",m&&c+" liked")},g=function(e){return r.a.createElement("button",{onClick:function(){return function(e){var t="/api/tweets/".concat(e,"/retweet/"),a={method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("accessToken"))}};fetch(t,a).then((function(e){e.status})).catch((function(e){return console.log(e)}))}(e.tweetId)},className:"prim-btn tweet-container-item cursor"},"retweet")},v=function(e){return r.a.createElement("section",{id:"tweets-container"},e.tweets.map((function(e){return r.a.createElement("article",{key:e.id,className:"tweet-container"},r.a.createElement(l.b,{to:"/profile/".concat(e.user.username)},r.a.createElement("h3",{className:"tweet-container-item"},e.user.username)),r.a.createElement("p",{className:"tweet-container-item"},e.is_retweet&&e.retweet.content,!e.is_retweet&&e.content),r.a.createElement(b,{tweetId:e.id,tweetLikes:e.likes,isLiked:e.isLiked}),r.a.createElement(g,{tweetId:e.id}))})))},w=function(){var e=Object(n.useState)([]),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),l=Object(i.a)(o,2),s=l[0],m=l[1],u=Object(n.useState)(!1),d=Object(i.a)(u,2),f=d[0],h=d[1],E=Object(n.useState)(!1),b=Object(i.a)(E,2),g=b[0],w=b[1];Object(n.useEffect)((function(){var e={method:"get",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json",Accept:"application/json",Authorization:"Token  ".concat(localStorage.getItem("accessToken"))}};fetch("/api/tweets/",e).then((function(e){if(200===e.status)return e.json()})).then((function(e){h(!0),c(e)})).catch((function(e){h(!0),m(!0),console.log(e)}))}),[g]);return r.a.createElement("main",{id:"page-container"},r.a.createElement(p,{onTweetAdd:function(){w(!g)}}),!f&&r.a.createElement("h1",{className:"message"},"Loading"),s&&r.a.createElement("h1",{className:"message"},"Error"),!s&&r.a.createElement(v,{tweets:a||[]}))},j=(a(33),function(){var e=Object(n.useContext)(m),t=e.isAuthenticated,a=e.setIsAuthenticated,c=Object(n.useState)(""),o=Object(i.a)(c,2),l=o[0],u=o[1],d=Object(n.useState)(""),f=Object(i.a)(d,2),h=f[0],E=f[1],p=Object(s.g)();return t?r.a.createElement(s.a,{to:"/home"}):r.a.createElement("main",{id:"page-container"},r.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault();var t={username:l,password:h},n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};fetch("/api/auth/login/",n).then((function(e){if(u(""),E(""),200===e.status)return e.json();if(401===e.status)throw new Error("Try again");if(400===e.status)throw new Error("Try again")})).then((function(e){localStorage.setItem("accessToken",e.token),a(!0),p.push("/home")})).catch((function(e){return alert(e)}))}(e)},action:"",method:"POST",className:"form-container"},r.a.createElement("div",{className:"form-item"},r.a.createElement("h1",null,"Log In")),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",{htmlFor:"id_username"},"Username"),r.a.createElement("input",{type:"text",name:"username",id:"id_username",value:l,onChange:function(e){return u(e.target.value)}})),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",{htmlFor:"id_password"},"Password"),r.a.createElement("input",{type:"password",name:"password",id:"id_password",value:h,onChange:function(e){return E(e.target.value)}})),r.a.createElement("div",{className:"form-item"},r.a.createElement("input",{type:"submit",value:"Log In",className:"prim-btn cursor"}))))}),O=function(){var e=Object(n.useContext)(m).isAuthenticated,t=Object(n.useState)(""),a=Object(i.a)(t,2),c=a[0],o=a[1],u=Object(n.useState)(""),d=Object(i.a)(u,2),f=d[0],h=d[1],E=Object(n.useState)(""),p=Object(i.a)(E,2),b=p[0],g=p[1],v=Object(n.useState)(""),w=Object(i.a)(v,2),j=w[0],O=w[1],N=Object(n.useState)(""),S=Object(i.a)(N,2),k=S[0],T=S[1],_=Object(n.useState)(""),y=Object(i.a)(_,2),C=y[0],I=y[1],A=Object(s.g)();return e?r.a.createElement(s.a,{to:"/home"}):r.a.createElement("main",{id:"page-container"},r.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault();var t={username:c,password:f,password2:b,email:j,firstName:k,lastName:C},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};fetch("/api/auth/register/",a).then((function(e){if(o(""),h(""),g(""),O(""),T(""),I(""),201===e.status&&A.push("/auth/login"),400===e.status)return e.json()})).then((function(e){console.log(e)})).catch((function(e){return alert(e)}))}(e)},action:"",method:"POST",className:"form-container"},r.a.createElement("div",{className:"form-item"},r.a.createElement("h1",null,"Register")),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",{htmlFor:"id_username"},"Username"),r.a.createElement("input",{type:"text",name:"username",id:"id_username",value:c,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",{htmlFor:"id_password"},"Password"),r.a.createElement("input",{type:"password",name:"password",id:"id_password",value:f,onChange:function(e){return h(e.target.value)}})),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",{htmlFor:"id_password2"},"Confirm Password"),r.a.createElement("input",{type:"password",name:"password2",id:"id_password2",value:b,onChange:function(e){return g(e.target.value)}})),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",{htmlFor:"id_email"},"Email"),r.a.createElement("input",{type:"email",name:"email",id:"id_email",value:j,onChange:function(e){return O(e.target.value)}})),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",{htmlFor:"id_first_name"},"First Name (Optional)"),r.a.createElement("input",{type:"text",name:"first_name",id:"id_first_name",value:k,onChange:function(e){return T(e.target.value)}})),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",{htmlFor:"id_last_name"},"Last Name (Optional)"),r.a.createElement("input",{type:"text",name:"last_name",id:"id_last_name",value:C,onChange:function(e){return I(e.target.value)}})),r.a.createElement("div",{className:"form-item"},r.a.createElement("input",{type:"submit",value:"Register",className:"prim-btn cursor"})),r.a.createElement("div",null,r.a.createElement("p",null,"Already a user? ",r.a.createElement(l.b,{to:"/auth/login",className:"link"},"Login")))))},N=function(){return r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/auth/login"},r.a.createElement(h,null),r.a.createElement(j,null)),r.a.createElement(s.b,{path:"/auth/register"},r.a.createElement(h,null),r.a.createElement(O,null)))},S=function(){return r.a.createElement("main",{id:"welcome"},r.a.createElement("div",{id:"join-us"},r.a.createElement(l.b,{to:"/auth/register"},r.a.createElement("h1",null,"Join Us"))))},k=(a(34),function(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),l=Object(i.a)(o,2),m=l[0],u=l[1],d=Object(s.h)().username;return Object(n.useEffect)((function(){var e="/api/profiles/".concat(d,"/"),t={method:"GET",headers:{Authorization:"Token ".concat(localStorage.getItem("accessToken"))}};fetch(e,t).then((function(e){if(200===e.status)return e.json()})).then((function(e){c(e.user_data),u(e.tweets_data)})).catch((function(e){return console.log(e)}))}),[d]),r.a.createElement("main",{id:"page-container",className:"container"},r.a.createElement("section",{id:"profile-info"},r.a.createElement("header",{id:"profile-header",className:"flexed"},r.a.createElement("div",{id:"profile-pic"}),a.is_current_user&&r.a.createElement("h3",{className:"prim-btn-2 cursor"},"Edit Profile")),r.a.createElement("h1",{className:"bolder"},a.first_name," ",a.last_name),r.a.createElement("p",null,"@",a.username),r.a.createElement("p",null,"Joined ",a.date_joined),r.a.createElement("p",null,r.a.createElement("span",{className:"bolder"},"36")," Following ",r.a.createElement("span",{className:"bold"}," 36 "),"Followers")),r.a.createElement(v,{tweets:m}))}),T=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1],o={isAuthenticated:a,setIsAuthenticated:c};return Object(n.useEffect)((function(){var e=localStorage.getItem("accessToken");c(!!e)}),[a]),r.a.createElement(m.Provider,{value:o},r.a.createElement(l.a,null,r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/"},r.a.createElement(S,null)),r.a.createElement(s.b,{path:"/auth"},r.a.createElement(N,null)),r.a.createElement(d,{exact:!0,path:"/home",isAuthenticated:a},r.a.createElement(h,null),r.a.createElement(w,null)),r.a.createElement(d,{exact:!0,path:"/profile/:username"},r.a.createElement(h,null),r.a.createElement(k,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[18,1,2]]]);
//# sourceMappingURL=main.5d0ed074.chunk.js.map